<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <!-- This is broken by doc revisioning.
         -->
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Bletiny api - Apache Mynewt</title>

        <link href="../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/base.css" rel="stylesheet">
        <link href="../../../css/custom.css" rel="stylesheet">
        <link href="../../../css/v2.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
            (function(i, s, o, g, r, a, m) {
    i["GoogleAnalyticsObject"] = r;
    (i[r] =
        i[r] ||
        function() {
            (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
    (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
})(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");

ga("create", "UA-72162311-1", "auto");
ga("send", "pageview");
</script>
        
    </head>


    <body class="Bletiny api">


        <div class="container">
    <div class="row v2-main-banner">
        <a class="logo-cell" href="/">
            <img class="logo" src="/img/logo.png">
        </a>
        <div class="tagline-cell">
            <h4 class="tagline">An OS to build, deploy and securely manage billions of devices</h4>
        </div>
        <div class="news-cell">
            <div class="well">
                <h4>Latest News:</h4> <a href="/download">Apache Mynewt 1.7.0, Apache NimBLE 1.2.0 </a> released (August 4, 2019)
            </div>
        </div>
    </div>
</div>

        






<nav id="navbar" class="navbar navbar-inverse affix-top" data-spy="affix" data-offset-top="150" role="navigation">
    <div class="container">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li 
  class=""
>
                    <a href="/"><i class="fa fa-home" style="font-size: larger;"></i></a>
                </li>
                <li 
  class="important"
>
                    <a href="/quick-start/">Quick Start</a>
                </li>
                <li 
  class=""
>
                    <a href="/about/">About</a>
                </li>
                <li 
  class=""
>
                    <a href="/talks/">Talks</a>
                </li>
                <li 
  class="active"
>
                    <a href="/documentation/">Documentation</a>
                </li>
                <li 
  class=""
>
                    <a href="/download/">Download</a>
                </li>
                <li 
  class=""
>
                    <a href="/community/">Community</a>
                </li>
                <li 
  class=""
>
                    <a href="/events/">Events</a>
                </li>
            </ul>

        </div>
    </div>
</nav>

        

        <div class="container">
            
                <div class="row">
                    <div class="col-md-3 v2-sidebar sidebar-container"><div id="docSidebar" class="hidden-print" role="complementary">
    <div class="top">
        <div role="search">
            <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" class="form-control" placeholder="Search documentation" />
                </div>
            </form>
        </div>
    </div>
    <ul class="toc-nav">
      <li class="doc-version"><select class="form-control" onchange="if (this.value) window.location.href=this.value">
  <option value="/latest">
    Version: master
  </option>
  <option value="/v1_7_0/" >
    Version: 1.7.0
  </option>
  <option value="/v1_6_0/" >
    Version: 1.6.0
  </option>
  <option value="/v1_5_0/" >
    Version: 1.5.0
  </option>
  <option value="/v1_4_0/" >
    Version: 1.4.0
  </option>
  <option value="/v1_3_0/os/introduction" >
    Version: 1.3.0
  </option>
  <option value="/v1_2_0/os/introduction" >
    Version: 1.2.0
  </option>
  <option value="/v1_1_0/os/introduction" selected="selected" >
    Version: 1.1.0
  </option>
  <option value="/v1_0_0/os/introduction" >
    Version: 1.0.0
  </option>
  <option value="/v0_9_0/os/introduction" >
    Version: 0.9.0
  </option>
</select></li>
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  
    <li ><a href="../../../os/introduction/">Mynewt Documentation</a>
  
  
    </li>

        
      
        
          
  
  
    <li><a href="
  ../../../faq/go_env/
">Appendix</a>
  
  
    </li>

        
      
    </ul>
</div></div>

                    <div class="col-md-9" role="main">
                        <div class="doc-header">
                            <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="/documentation/">Docs</a></li>
    
    
      
        <li>&raquo; Bletiny api</li>
      
    
    
      <li class="wy-breadcrumbs-aside">
        
          <a href="https://github.com/apache/mynewt-site/blob/master/docs/network/ble/bletiny_api.md"
            class="icon icon-github"> Edit on GitHub</a>
        
      </li>
    
  </ul>
</div>
                        </div>
                        
                          
                        
                          
                        
                          
                        
                          
                            <div class="alert alert-warning">
                                <p>
                                    Version 1.1.0 is not the most recent version of the Apache Mynewt
                                    documentation. Click <a href="/latest">here</a> to read the latest
                                    version.
                                </p>
                            </div>
                          
                        
                        
                            <h2 id="api-for-bletiny-app">API for bletiny app</h2>
<p>"bletiny" is one of the sample applications that come with Mynewt. It is a simple shell application which provides a basic interface to the host-side of the BLE stack. "bletiny" includes all the possible roles (Central/Peripheral) and they may be run simultaneously. You can run bletiny on a board and issue commands that make it behave as a central or a peripheral with different peers. </p>
<p>Highlighted below are some of the ways you can use the API to establish connections and discover services and characteristics from peer devices. For descriptions of the full API, go to the next sections on <a href="../bletiny/bletiny_GAP/">GAP in bletiny</a> and <a href="../bletiny/bletiny_GATT/">GATT in bletiny</a>.</p>
<p><br></p>
<h3 id="set-device-public-address">Set device public address.</h3>
<p>Currently the device public address is hardcoded to <code>0a:0b:0c:0d:0e:0f</code> in <code>bletiny</code> app but you can change it by going into its source code and initializing it to the desired value as described in the section on how to <a href="ini_stack/ble_devadd.md">initialize device addr</a>. </p>
<p><br></p>
<h3 id="initiate-a-direct-connection-to-a-device">Initiate a direct connection to a device</h3>
<p>In this case, your board is acting as a central and initiating a connection with another BLE device. The example assumes you know the address of the peer, either by scanning for available peers or because you have set up the peer yourself.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code><span style="background-color: #ffffcc">b conn addr_type=public addr=d4:f5:13:53:d2:43
</span>[ts=118609ssb, mod=64 level=2] connection complete; status=0 handle=1 peer_addr_type=0 peer_addr=0x43:0xd2:0x53:0x13:0xf5:0xd4 conn_itvl=40 conn_latency=0 supervision_timeout=256
</code></pre></div>


<p>The <code>handle=1</code> in the output indicates that it is connection-1.</p>
<p><br></p>
<h3 id="configure-advertisements-to-include-device-name">Configure advertisements to include device name</h3>
<p>In this case, your board is acting as a peripheral. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b set adv_data name=&lt;your-device-name&gt;
</code></pre></div>


<p><br></p>
<h3 id="begin-sending-undirected-general-advertisements">Begin sending undirected general advertisements</h3>
<p>In this case, your board is acting as a peripheral. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b adv conn=und disc=gen
</code></pre></div>


<p><br></p>
<h3 id="show-established-connections">Show established connections.</h3>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b show conn
</code></pre></div>


<p><br></p>
<h3 id="discover-and-display-peers-services">Discover and display peer's services.</h3>
<p>This is how you discover and then display the services of the peer you established earlier across connection-1.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code><span style="background-color: #ffffcc">b disc svc conn=1
</span><span style="background-color: #ffffcc">b show chr
</span>[ts=132425ssb, mod=64 level=2] CONNECTION: handle=1 addr=d4:f5:13:53:d2:43
[ts=132428ssb, mod=64 level=2]     start=1 end=5 uuid=0x1800
[ts=132433ssb, mod=64 level=2]     start=6 end=16 uuid=0x1808
[ts=132437ssb, mod=64 level=2]     start=17 end=31 uuid=0x180a
[ts=132441ssb, mod=64 level=2]     start=32 end=65535 uuid=00000000-0000-1000-1000000000000000
</code></pre></div>


<p><br></p>
<h3 id="discover-characteristics-for-each-service-on-peer">Discover characteristics for each service on peer</h3>
<p>The following examples show how to find the characteristics for each service available on the peer device across connection-1. The start and end values depend on the specific services discovered using the previous command <code>b show chr</code>. Continuing with the example above, you can discover the characteristics of the first service and display it using the following commands.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code><span style="background-color: #ffffcc">b disc chr conn=1 start=1 end=5
</span><span style="background-color: #ffffcc">b show chr
</span>[ts=163063ssb, mod=64 level=2] CONNECTION: handle=1 addr=d4:f5:13:53:d2:43
[ts=163067ssb, mod=64 level=2]     start=1 end=5 uuid=0x1800
[ts=163071ssb, mod=64 level=2]         def_handle=2 val_handle=3 properties=0x02 uuid=0x2a00
[ts=163078ssb, mod=64 level=2]         def_handle=4 val_handle=5 properties=0x02 uuid=0x2a01
[ts=163085ssb, mod=64 level=2]     start=6 end=16 uuid=0x1808
[ts=163089ssb, mod=64 level=2]     start=17 end=31 uuid=0x180a
[ts=163094ssb, mod=64 level=2]     start=32 end=65535 uuid=00000000-0000-1000-1000000000000000
</code></pre></div>


<p>You can next discover characteristics for the second service and display. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code><span style="background-color: #ffffcc">b disc chr conn=1 start=6 end=16
</span><span style="background-color: #ffffcc">b show chr
</span>[ts=180631ssb, mod=64 level=2] CONNECTION: handle=1 addr=d4:f5:13:53:d2:43
[ts=180634ssb, mod=64 level=2]     start=1 end=5 uuid=0x1800
[ts=180639ssb, mod=64 level=2]         def_handle=2 val_handle=3 properties=0x02 uuid=0x2a00
[ts=180646ssb, mod=64 level=2]         def_handle=4 val_handle=5 properties=0x02 uuid=0x2a01
[ts=180653ssb, mod=64 level=2]     start=6 end=16 uuid=0x1808
[ts=180657ssb, mod=64 level=2]         def_handle=7 val_handle=8 properties=0x10 uuid=0x2a18
[ts=180664ssb, mod=64 level=2]         def_handle=10 val_handle=11 properties=0x02 uuid=0x2a51
[ts=180672ssb, mod=64 level=2]         def_handle=12 val_handle=13 properties=0x28 uuid=0x2a52
[ts=180679ssb, mod=64 level=2]         def_handle=15 val_handle=16 properties=0x02 uuid=0x2a08
[ts=180686ssb, mod=64 level=2]     start=17 end=31 uuid=0x180a
[ts=180691ssb, mod=64 level=2]     start=32 end=65535 uuid=00000000-0000-1000-1000000000000000
</code></pre></div>


<p><br></p>
<h3 id="discover-descriptors-for-each-characteristic-on-peer">Discover descriptors for each characteristic on peer</h3>
<p>Just as before, the start and end values depend on the specific characteristics discovered.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b disc dsc conn=1 start=1 end=5
b disc dsc conn=1 start=6 end=16
b disc dsc conn=1 start=17 end=31
</code></pre></div>


<p><br></p>
<h3 id="read-an-attribute-belonging-to-the-peer">Read an attribute belonging to the peer</h3>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b read conn=1 attr=18 attr=21
</code></pre></div>


<p><br></p>
<h3 id="write-to-an-attribute-belonging-to-the-peer">Write to an attribute belonging to the peer</h3>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b write conn=1 attr=3 value=0x01:0x02:0x03
</code></pre></div>


<p><br></p>
<h3 id="perform-a-passive-scan">Perform a passive scan</h3>
<p>This is how you tell your board to listen to all advertisements around it. The duration is specified in ms.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b scan dur=1000 disc=gen type=passive filt=no_wl
</code></pre></div>


<p><br></p>
                        
                        <div class="row">
                            



<ul class="nav nav-pills" style="margin-bottom: 10px">
    <li>
    
    </li>
    <li class="pull-right">
    
    </li>
</ul>
                        </div>
                        <footer class="row">
    <div class="col-xs-12">
        
            <p class="copyright">Apache Mynewt is available under Apache License, version 2.0.</p>
        
    </div>
    <div class="col-xs-12">
        <div class="logos">
            <img src="/img/asf_logo_wide_small.png" alt="Apache" title="Apache">
            <small class="footnote">
                Apache Mynewt, Mynewt, Apache, the Apache feather logo, and the Apache Mynewt
                project logo are either registered trademarks or trademarks of the Apache
                Software Foundation in the United States and other countries.
            </small>
            <a href="">
                <img src="https://www.countit.com/images/add_to_slack.png" alt="Slack Icon" title="Join our Slack Community" />
            </a>
        </div>
    </div>
</footer>
                    </div>
                </div>
            
            
        </div>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
        <script src="../../../js/custom.js"></script>
            <script src="search/main.js"></script>

    </body>
</html>