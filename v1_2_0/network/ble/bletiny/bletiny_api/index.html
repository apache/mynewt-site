<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <!-- This is broken by doc revisioning.
         -->
        <link rel="shortcut icon" href="../../../../img/favicon.ico">

        <title>toc - Apache Mynewt</title>

        <link href="../../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../../css/highlight.css">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link href="../../../../css/custom.css" rel="stylesheet">
        <link href="../../../../css/v2.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
            (function(i, s, o, g, r, a, m) {
    i["GoogleAnalyticsObject"] = r;
    (i[r] =
        i[r] ||
        function() {
            (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
    (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
})(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");

ga("create", "UA-72162311-1", "auto");
ga("send", "pageview");
</script>
        
    </head>


    <body class="toc">


        <div class="container">
    <div class="row v2-main-banner">
        <a class="logo-cell" href="/">
            <img class="logo" src="/img/logo.png">
        </a>
        <div class="tagline-cell">
            <h4 class="tagline">An OS to build, deploy and securely manage billions of devices</h4>
        </div>
        <div class="news-cell">
            <div class="well">
                <h4>Latest News:</h4> <a href="/download">Apache Mynewt 1.10.0, Apache NimBLE 1.5.0 </a> released (May 6, 2022)
            </div>
        </div>
    </div>
</div>

        






<nav id="navbar" class="navbar navbar-inverse affix-top" data-spy="affix" data-offset-top="150" role="navigation">
    <div class="container">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li 
  class=""
>
                    <a href="/"><i class="fa fa-home" style="font-size: larger;"></i></a>
                </li>
                <li 
  class="important"
>
                    <a href="/quick-start/">Quick Start</a>
                </li>
                <li 
  class=""
>
                    <a href="/about/">About</a>
                </li>
                <li 
  class=""
>
                    <a href="/talks/">Talks</a>
                </li>
                <li 
  class="active"
>
                    <a href="/documentation/">Documentation</a>
                </li>
                <li 
  class=""
>
                    <a href="/download/">Download</a>
                </li>
                <li 
  class=""
>
                    <a href="/community/">Community</a>
                </li>
                <li 
  class=""
>
                    <a href="/events/">Events</a>
                </li>
            </ul>

        </div>
    </div>
</nav>

        

        <div class="container">
            
                <div class="row">
                    <div class="col-md-3 v2-sidebar sidebar-container"><div id="docSidebar" class="hidden-print" role="complementary">
    <div class="top">
        <div role="search">
            <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" class="form-control" placeholder="Search documentation" />
                </div>
            </form>
        </div>
    </div>
    <ul class="toc-nav">
      <li class="doc-version"><select class="form-control" onchange="if (this.value) window.location.href=this.value">
  <option value="/latest">
    Version: master
  </option>
  <option value="/v1_10_0/" >
    Version: 1.10.0
  </option>
  <option value="/v1_9_0/" >
    Version: 1.9.0
  </option>
    <option value="/v1_8_0/" >
    Version: 1.8.0
  </option>
  <option value="/v1_7_0/" >
    Version: 1.7.0
  </option>
  <option value="/v1_6_0/" >
    Version: 1.6.0
  </option>
  <option value="/v1_5_0/" >
    Version: 1.5.0
  </option>
  <option value="/v1_4_0/" >
    Version: 1.4.0
  </option>
  <option value="/v1_3_0/os/introduction" >
    Version: 1.3.0
  </option>
  <option value="/v1_2_0/os/introduction" selected="selected" >
    Version: 1.2.0
  </option>
  <option value="/v1_1_0/os/introduction" >
    Version: 1.1.0
  </option>
  <option value="/v1_0_0/os/introduction" >
    Version: 1.0.0
  </option>
  <option value="/v0_9_0/os/introduction" >
    Version: 0.9.0
  </option>
</select></li>
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  
    <li ><a href="../../../../os/introduction/">Mynewt Documentation</a>
  
  
    <ul>
          
              
          
              
                
  
  
    <li ><a href="../../../../os/get_started/get_started/">Basic Setup</a>
  
  
    </li>

              
          
              
                
  <li >
    <a href="../../../../os/get_started/vocabulary/">Concepts</a>
  </li>

              
          
              
                
  
  
    <li ><a href="../../../../os/tutorials/tutorials/">Tutorials</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../os/os_user_guide/">OS User Guide</a>
  
  
    </li>

              
          
              
                
  
  
    <li><a href="
  ../../ble_intro/
">BLE User Guide</a>
  
  
    <ul>
          
              
                
  <li >
    <a href="../../ble_intro/">NimBLE Introduction</a>
  </li>

              
          
              
                
  <li >
    <a href="../../ble_sec/">NimBLE Security</a>
  </li>

              
          
              
                
  
  
    <li ><a href="../../ble_setup/ble_setup_intro/">NimBLE Setup</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../ble_hs/ble_hs/">NimBLE Host API</a>
  
  
    </li>

              
          
              
                
  
  
    <li class="active"><a href="./">bletiny app Usage API</a>
  
  
    <ul>
          
              
          
              
                
  <li >
    <a href="../bletiny_GAP/">GAP in bletiny</a>
  </li>

              
          
              
                
  <li >
    <a href="../bletiny_GATT/">GATT in bletiny</a>
  </li>

              
          
              
                
  <li >
    <a href="../bletiny_advdata/">Advertisement Data Fields</a>
  </li>

              
          
    </ul>
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../btshell/btshell_api/">btshell app Usage API</a>
  
  
    </li>

              
          
    </ul>
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../newt/newt_intro/">Newt Tool Guide</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../newtmgr/overview/">Newt Manager Guide</a>
  
  
    </li>

              
          
              
                
  <li >
    <a href="../../../../known_issues/">Known Issues</a>
  </li>

              
          
    </ul>
  
    </li>

        
      
        
          
  
  
    <li><a href="
  ../../../../newt/install/prev_releases/
">Appendix</a>
  
  
    </li>

        
      
    </ul>
</div></div>

                    <div class="col-md-9" role="main">
                        <div class="doc-header">
                            <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="/documentation/">Docs</a></li>
    
    
        
          <li>&raquo; bletiny app Usage API</li>
        
      
        
          <li>&raquo; <a href="network/ble/ble_intro/">BLE User Guide</a></li>
        
      
        
          <li>&raquo; <a href="os/introduction/">Mynewt Documentation</a></li>
        
      
      
    
    
      <li class="wy-breadcrumbs-aside">
        
          <a href="https://github.com/apache/mynewt-site/blob/master/docs/network/ble/bletiny/bletiny_api.md"
            class="icon icon-github"> Edit on GitHub</a>
        
      </li>
    
  </ul>
</div>
                        </div>
                        
                          
                        
                          
                        
                          
                        
                          
                        
                          
                            <div class="alert alert-warning">
                                <p>
                                    Version 1.2.0 is not the most recent version of the Apache Mynewt
                                    documentation. Click <a href="/latest">here</a> to read the latest
                                    version.
                                </p>
                            </div>
                          
                        
                        
                            <h2 id="api-for-bletiny-app">API for bletiny app</h2>
<p>"bletiny" is one of the sample applications that come with Mynewt. It is a shell application which provides a basic interface to the host-side of the BLE stack. "bletiny" includes all the possible roles (Central/Peripheral) and they may be run simultaneously. You can run bletiny on a board and issue commands that make it behave as a central or a peripheral with different peers. </p>
<p>"bletiny" is a BLE application which uses the 1.0 shell. If you want to use the 1.1 shell in BLE application please go to <a href="../../btshell/btshell_api/">btshell app</a>.</p>
<p>Highlighted below are some of the ways you can use the API to establish connections and discover services and characteristics from peer devices. For descriptions of the full API, go to the next sections on <a href="../bletiny_GAP/">GAP in bletiny</a> and <a href="../bletiny_GATT/">GATT in bletiny</a>.</p>
<p>All bletiny commands are prefixed with <code>b</code>.  This prefix distinguished bletiny commands from other shell commands that are implemented by other Mynewt packages.</p>
<p><br></p>
<h3 id="set-device-address">Set device address.</h3>
<p>On startup, bletiny has the following identity address configuration:</p>
<ul>
<li>Public address: None</li>
<li>Random address: None</li>
</ul>
<p>The below <code>set</code> commands can be used to change the address configuration:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b set addr_type=public addr=&lt;device-address&gt;
b set addr_type=random addr=&lt;device-address&gt;
</code></pre></div>


<p>For example:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b set addr_type=public addr=01:02:03:04:05:06
b set addr_type=random addr=c1:aa:bb:cc:dd:ee
</code></pre></div>


<p>The address configuration can be viewed with the <code>b show addr</code> command, as follows:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b show addr
public_id_addr=01:02:03:04:05:06 random_id_addr=c1:aa:bb:cc:dd:ee
</code></pre></div>


<p><br></p>
<h3 id="initiate-a-direct-connection-to-a-device">Initiate a direct connection to a device</h3>
<p>In this case, your board is acting as a central and initiating a connection with another BLE device. The example assumes you know the address of the peer, either by scanning for available peers or because you have set up the peer yourself.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code><span style="background-color: #ffffcc">b conn own_addr_type=public peer_addr_type=public peer_addr=d4:f5:13:53:d2:43
</span>connection established; handle=1 our_ota_addr_type=0 our_ota_addr=0a:0b:0c:0d:0e:0f out_id_addr_type=0 our_id_addr=0a:0b:0c:0d:0e:0f peer_addr_type=0 peer_addr=43:d2:53:13:f5:d4 conn_itvl=40 conn_latency=0 supervision_timeout=256 encrypted=0 authenticated=0 bonded=0
</code></pre></div>


<p>The <code>handle=1</code> in the output indicates that it is connection-1.</p>
<p><br></p>
<h3 id="configure-advertisements-to-include-device-name">Configure advertisements to include device name</h3>
<p>In this case, your board is acting as a peripheral. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b set adv_data name=&lt;your-device-name&gt;
</code></pre></div>


<p><br></p>
<h3 id="begin-sending-undirected-general-advertisements">Begin sending undirected general advertisements</h3>
<p>In this case, your board is acting as a peripheral. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b adv conn=und disc=gen
</code></pre></div>


<p><br></p>
<h3 id="show-established-connections">Show established connections.</h3>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b show conn
</code></pre></div>


<p><br></p>
<h3 id="discover-and-display-peers-services-characteristics-and-descriptors">Discover and display peer's services, characteristics, and descriptors.</h3>
<p>This is how you discover and then display the services of the peer you established earlier across connection-1.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code><span style="background-color: #ffffcc">b disc full conn=1
</span><span style="background-color: #ffffcc">b show chr
</span>[ts=132425ssb, mod=64 level=2] CONNECTION: handle=1 addr=d4:f5:13:53:d2:43
[ts=132428ssb, mod=64 level=2]     start=1 end=5 uuid=0x1800
[ts=132433ssb, mod=64 level=2]     start=6 end=16 uuid=0x1808
[ts=132437ssb, mod=64 level=2]     start=17 end=31 uuid=0x180a
[ts=132441ssb, mod=64 level=2]     start=32 end=65535 uuid=00000000-0000-1000-1000000000000000
</code></pre></div>


<p><br></p>
<h3 id="read-an-attribute-belonging-to-the-peer">Read an attribute belonging to the peer</h3>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b read conn=1 attr=21
</code></pre></div>


<p><br></p>
<h3 id="write-to-an-attribute-belonging-to-the-peer">Write to an attribute belonging to the peer</h3>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b write conn=1 attr=3 value=0x01:0x02:0x03
</code></pre></div>


<p><br></p>
<h3 id="perform-a-passive-scan">Perform a passive scan</h3>
<p>This is how you tell your board to listen to all advertisements around it. The duration is specified in ms.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span></span><code>b scan dur=1000 type=passive filt=no_wl
</code></pre></div>
                        
                        <div class="row">
                            



<ul class="nav nav-pills" style="margin-bottom: 10px">
    <li>
    
    </li>
    <li class="pull-right">
    
    </li>
</ul>
                        </div>
                        <footer class="row">
    <div class="col-xs-12">
        
            <p class="copyright">Apache Mynewt is available under Apache License, version 2.0.</p>
        
    </div>
    <div class="col-xs-12">
        <div class="logos">
            <a href="https://www.apache.org/">
                <img src="/img/asf_logo_wide_small.png" alt="Apache" title="Apache">
            </a>
            <p>
                Copyright Â© 2015-2021 The Apache Software Foundation.<br>
                <small class="footnote">
                    Apache Mynewt, Mynewt, Apache, the Apache feather logo, and the Apache Mynewt
                    project logo are either registered trademarks or trademarks of the Apache
                    Software Foundation in the United States and other countries.
                </small>
            </p>
            <a href="">
                <img src="https://www.countit.com/images/add_to_slack.png" alt="Slack Icon" title="Join our Slack Community" />
            </a>
        </div>
    </div>
    <a href="https://www.apache.org/licenses/">
        <button class="button-footer-asf">
            License
        </button>
    </a>
    <a href="https://www.apache.org/foundation/sponsorship.html">
        <button class="button-footer-asf">
            Sponsorship
        </button>
    </a>
    <a href="https://www.apache.org/foundation/thanks.html">
        <button class="button-footer-asf">
            Thanks
        </button>
    </a>
    <a href="https://www.apache.org/security/">
        <button class="button-footer-asf">
            Security
        </button>
    </a>
    <a href="https://apache.org/events/current-event">
        <button class="button-footer-asf">
            ASF Events
        </button>
    </a>
</footer>
                    </div>
                </div>
            
            
        </div>

        <script src="../../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../../js/highlight.pack.js"></script>
        <script src="../../../../js/base.js"></script>
        <script src="../../../../js/custom.js"></script>
            <script src="search/main.js"></script>

    </body>
</html>